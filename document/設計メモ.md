# 設計メモ

- scan.py
- analyze.py
- visualized.py
- node
  - packet.py
  - device.py
- log
  - ログファイルの保管フォルダ
- test
  - いろんなテストに使ったスクリプトが保管されている
- devices.csv
  - 各デバイスの情報を保存

## スクリプトの詳細

## scan.py

- BLE パケットをスキャンするクラスである ScanDelegate を定義
- 各クラスや関数は[bluepy]()を用いている
- スクリプトを起動すると強制停止するまでパケットをキャプチャし続ける
- sudo での実行が必須となっています

### ScanDelegate クラス

- **init**
  - コンストラクタ。DefaultDelegate をセットしている
- handleDiscovery
  - パケットがキャプチャした時に呼び出される関数。キャプチャデータの表示方法等を定義している

## analyze.py

log フォルダにある最新ファイルを取得してその中から光らせる情報を取得する

### 定数

- DEVICE_CSV:デバイス情報の CSV ファイルのパスを指定している
- MIN_RSSI:RSSI の最小値を定義

### 関数

- readLog
  - 引数:path 読み込むファイルのパス
  - 引数のログフォルダを読み込んでその中から光らせるパケットを選択する
  - 返り値:必要データが揃っている　かつ　 RSSI が MIN_RSSI 以上ものの中から RSSI が最も大きいパケットのデータを返す
- getNewLog
  - 返り値:最新のログフォルダのパスを返す
- main
  - 最新のログを解析して光らせるパケットの情報を標準出力する

## visualize.py

実際にパネルを光らせるスクリプト

### Neo クラス

### 関数

- readCSV(path)
  - 引数:path 読み込むファイルのパス
  - path のファイルを読み込む
  - 返り値:ファイルの読み込んだデータ
- getDeviceList
  - 引数:path 読み込むファイルのパス
  - 引数の CSV ファイルを読み込んで Device クラスの辞書を作成する。
  - キーを UUID、バリューを Device クラスのインスタンスとしている
  - 返り値:Device クラスの辞書

## device.py

デバイスのクラス

## packet.py

パケットのパケットのクラス

## device.csv

デバイス情報を csv で保存する
